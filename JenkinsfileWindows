pipeline {
    agent any
	node {
		def mvnHome
		stage('Preparation') { // for display purposes
		mvnHome = tool 'maven'
	}

    stages {
        stage('Build....') {
            steps {
                echo 'Building.....'
				bat(/"${mvnHome}\bin\mvn" -Dmaven.test.failure.ignore clean package/)
            }
        }
	
		stage('Results') {
			junit '**/target/surefire-reports/TEST-*.xml'
			archive 'target/*.jar'
		}
        
		stage('Testing') {
            steps {
                echo 'Test..'
				sh 'mvn surefire-report:report -DouputFile=junitreport.html'
            }
        }
		stage('JUnit Test') {
			steps {
				publishHTML([allowMissing: false, alwaysLinkToLastBuild: false, keepAll: false, reportDir: 'target/site/', reportFiles: 'surefire-report.html', reportName: 'HTML Report', reportTitles: ''])
            }
		}
     
		stage('Deploy') {
            steps {
                echo 'Deploying..'
            }
        }
    }
}
